<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.6"?>
<plugin>
   <extension
         point="org.eclipse.ui.views">
      <view
            category="fr.liglab.adele.cilia.workbench.monitoring.rootCategory"
            class="fr.liglab.adele.cilia.workbench.monitoring.topologyview.TopologyView"
            icon="platform:/plugin/fr.liglab.adele.cilia.workbench.common/icons/16/chain.png"
            id="fr.liglab.adele.cilia.workbench.monitoring.topologyview"
            name="Cilia topology"
            restorable="true">
      </view>
      <category
            id="fr.liglab.adele.cilia.workbench.monitoring.rootCategory"
            name="CILIA monitoring">
      </category>
      <view
            category="fr.liglab.adele.cilia.workbench.monitoring.rootCategory"
            class="fr.liglab.adele.cilia.workbench.monitoring.changesview.ChangesView"
            icon="platform:/plugin/fr.liglab.adele.cilia.workbench.common/icons/16/events.gif"
            id="fr.liglab.adele.cilia.workbench.monitoring.changesview"
            name="Changes on the Cilia platform"
            restorable="true">
      </view>
      <view
            category="fr.liglab.adele.cilia.workbench.monitoring.rootCategory"
            class="fr.liglab.adele.cilia.workbench.monitoring.topologyview.chainview.ChainView"
            id="fr.liglab.adele.cilia.workbench.monitoring.topologyview.chainview"
            name="Cilia chain viewer"
            restorable="true">
      </view>
   </extension>
   <extension
         point="org.eclipse.core.runtime.adapters">
      <factory
            adaptableType="fr.liglab.adele.cilia.ChainReadOnly"
            class="fr.liglab.adele.cilia.workbench.monitoring.topologyview.propertyview.ChainPropertiesAdapter">
         <adapter
               type="org.eclipse.ui.views.properties.IPropertySource">
         </adapter>
      </factory>
      <factory
            adaptableType="fr.liglab.adele.cilia.MediatorReadOnly"
            class="fr.liglab.adele.cilia.workbench.monitoring.topologyview.propertyview.MediatorPropertiesAdapter">
         <adapter
               type="org.eclipse.ui.views.properties.IPropertySource">
         </adapter>
      </factory>
      <factory
            adaptableType="fr.liglab.adele.cilia.CiliaContextReadOnly"
            class="fr.liglab.adele.cilia.workbench.monitoring.topologyview.propertyview.CiliaContextPropertiesAdapter">
         <adapter
               type="org.eclipse.ui.views.properties.IPropertySource">
         </adapter>
      </factory>
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <command
            id="fr.liglab.adele.cilia.workbench.monitoring.command.reloadModel"
            name="reloadModel">
      </command>
      <command
            id="fr.liglab.adele.cilia.workbench.monitoring.command.toggleAutoreload"
            name="toggleAutoreload">
         <state
               id="org.eclipse.ui.commands.toggleState">
               <class
                     class="org.eclipse.ui.handlers.RegistryToggleState">
                     <parameter 
               name="default" 
               value="false"> 
         </parameter> 
         <parameter 
               name="persisted" 
               value="false"> 
         </parameter> 
               </class>
         </state>
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="false"
            locationURI="toolbar:fr.liglab.adele.cilia.workbench.monitoring.topologyview">
         <command
               commandId="fr.liglab.adele.cilia.workbench.monitoring.command.toggleAutoreload"
               icon="platform:/plugin/fr.liglab.adele.cilia.workbench.common/icons/16/different.png"
               label="Toggle auto-reload"
               style="toggle">               
         </command>
         <command
               commandId="fr.liglab.adele.cilia.workbench.monitoring.command.reloadModel"
               icon="platform:/plugin/fr.liglab.adele.cilia.workbench.common/icons/reload.svg"
               label="Reload model"
               style="push">
         </command>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.ui.startup">
      <startup
            class="fr.liglab.adele.cilia.workbench.monitoring.EarlyStartupManager">
      </startup>
   </extension>
   <extension
         point="org.eclipse.ui.services">
      <sourceProvider
            provider="fr.liglab.adele.cilia.workbench.monitoring.topologyview.VariablesSourceProvider">
         <variable
               name="fr.liglab.adele.cilia.workbench.monitoring.topologyview.reloadRequired"
               priorityLevel="workbench">
         </variable>
      </sourceProvider>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="fr.liglab.adele.cilia.workbench.monitoring.command.ReloadModelHandler"
            commandId="fr.liglab.adele.cilia.workbench.monitoring.command.reloadModel">
         <enabledWhen>
            <with
                  variable="fr.liglab.adele.cilia.workbench.monitoring.topologyview.reloadRequired">
               <equals
                     value="required">
               </equals>
            </with>
         </enabledWhen>
      </handler>
      <handler
            class="fr.liglab.adele.cilia.workbench.monitoring.command.ToggleAutoReloadHandler"
            commandId="fr.liglab.adele.cilia.workbench.monitoring.command.toggleAutoreload">
      </handler>
   </extension>

</plugin>
